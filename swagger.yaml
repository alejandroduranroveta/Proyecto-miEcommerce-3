openapi: 3.0.0
info:
  title: Mi ecommerce
  version: 1.0.0
  description: |-
    Esta es la API de Mi ecommerce.
    
    Links:
    - [Repositorio de Github](https://github.com/alejandroduranroveta/Proyecto-miEcommerce-3)
  
servers:
  - url: http://localhost:3000/api/v1
    description: Servidor de la api
    
tags:
  - name: Usuario
    description: Todos los endpoints de usuarios
  - name: Productos
    description: Todos los endpoints de productos
  - name: Carritos
    description: Todos los endpoint para carrito

  
paths:
  /users:
    get:
      tags: 
        - Usuario
      summary:  Recupera la lista de users. Responde con un array conteniendo todos los users del sistema..
      responses:
        '200':    # status code
          description: Un array de usuarios
          content:
            application/json:
              schema:
                type: array
                items: 
                  $ref: '#/components/schemas/Usuario'
        '500':
          description: Error del Servidor
    post:
      tags:
        - Usuario
      summary:  Crea un nuevo user. Debe recibir un body con la info del user a crear. Responde con la info completa del nuevo user.
      requestBody:
        description: Crea un nuevo user
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Usuario'
        required: true
      responses:
        '201':
          description: Creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Usuario'
        '400':
          description: Bad request
        '500':
          description: Error del servidor
  /users/{id}:
    get:
      tags: 
        - Usuario
      summary: Recupera el user con el id solicitado. Responde con la información completa del user con el id buscado.
      parameters:
        - in: path
          name: id
          schema:
            type: number
          required: true
          description: Id del usuario a buscar
      responses: 
        '200':
          description: El usuario encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Usuario'
        '404':
          description: Usuario no encontrado
        '500':
          description: Error del servidor
    put:
      tags:
        - Usuario
      summary: Actualiza el user identificado con id. Debe recibir un body con la info del user a modificar. Responde con la info completa del user modificado.
      parameters:
        - in: path
          name: id
          schema:
            type: number
          required: true
          description: Id del usuario a editar     
      requestBody:
        description: Editar el usuario
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Usuario'
        required: true
      responses: 
        '200':
          description: El usuario fue editado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Usuario'
        '400':
          description: Bad request
        '404':
          description: Usuario no encontrado
        '500':
          description: Error del servidor
    delete:
      tags:
        - Usuario
      summary: Eliminar el user identificado con id. Cuando se elimina un user, primero debe vaciarse su carrito (cart). 
      requestBody:
        description: Id del usuario a eliminar
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: number
                  example: 2
        required: true
      responses: 
        '200':
          description: El usuario fue eliminado
        '400':
          description: Bad request
        '404':
          description: Usuario no encontrado
        '500':
          description: Error del servidor
  /products:
    get:
      tags:
        - Productos
      summary: Recupera la lista de products. Responde con un array conteniendo todos los products del sistema.
      parameters:
        - in: query
          name: category
          schema:
            type: string
          required: false
          description: Si se desea filtrar por categoria          
      responses:
        '200':    # status code
          description: Un array de productos
          content:
            application/json:
              schema:
                type: array
                items: 
                  $ref: '#/components/schemas/Producto'
        '500':
          description: Error del Servidor
    post:
      tags:
        - Productos
      summary:  Crea un nuevo producto. Debe recibir un body con la info del producto a crear. Responde con la info completa del nuevo user.
      requestBody:
        description: Crea un nuevo producto
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Producto'
        required: true
      responses:
        '201':
          description: Creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Usuario'
        '400':
          description: Bad request
        '500':
          description: Error del servidor
  /products/{id}:
    get:
      tags: 
        - Productos
      summary: Recupera el producto con el id solicitado. Responde con la información completa del producto con el id buscado.
      parameters:
        - in: path
          name: id
          schema:
            type: number
          required: true
          description: Id del producto a buscar
      responses: 
        '200':
          description: El producto encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Producto'
        '404':
          description: Producto no encontrado
        '500':
          description: Error del servidor
    put:
      tags:
        - Productos
      summary: Actualiza el producto identificado con id. Debe recibir un body con la info del producto a modificar. Responde con la info completa del producto modificado.
      parameters:
        - in: path
          name: id
          schema:
            type: number
          required: true
          description: Id del producto a editar     
      requestBody:
        description: Editar el producto
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Producto'
        required: true
      responses: 
        '200':
          description: El producto fue editado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Producto'
        '400':
          description: Bad request
        '404':
          description: Producto no encontrado
        '500':
          description: Error del servidor
    delete:
      tags:
        - Productos
      summary: Eliminar el producto identificado con id. Cuando se elimina un producto, primero debe quitarse de todos los carritos, ademas de las imagenes. 
      parameters:
        - in: path
          name: id
          schema:
            type: number
          required: true
          description: Id del producto a eliminar
      responses: 
        '200':
          description: El producto fue eliminado
        '400':
          description: Bad request
        '404':
          description: producto no encontrado
        '500':
          description: Error del servidor
  /products/mostwanted:
    get:
      tags:
        - Productos
      summary: Recupera la lista de products. Responde con un array conteniendo todos los products del sistema que tengan el atributa most wanted en true.
      responses:
        '200':    # status code
          description: Un array de productos
          content:
            application/json:
              schema:
                type: array
                items: 
                  $ref: '#/components/schemas/Producto'
        '500':
          description: Error del Servidor
  /products/search?{q}:
    get:
      tags: 
        - Productos
      summary: Recupera los productos que contengan el palabra ingresada, tanto en su nombre, descripcion o categoria
      parameters:
        - in: query
          name: q
          schema:
            type: string
          required: true
          description: String a buscar
      responses: 
        '200':
          description: Los productos encontrados
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Producto'
        '500':
          description: Error del servidor
  
      
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Usuario:
      type: object
      properties:
        id:
          type: number
          example: 1
        email:
          type: string
          example: ejemplo@email.com
        username:
          type: string
          example: anon
        password:
          type: string
          example: 12232dse
        firstname:
          type: string
          example: Jefferson
        lastName:
          type: string
          example: Gutierritos
        profilepic:
          type: string
          example: shorturl.at/IJK45
      xml:
        name: usuarios
    Producto:
      type: object
      properties:
        id:
          type: number
          example: 1
        title: 
          type: string
          example: Manzanas rojas
        price: 
          type: number
          example: 49
        description:
          type: string
          example: Manzanas deliciosas y probablemente naturales
        image:
          type: string
          example: shorturl.at/IJK45
        gallery:
          type: array
          items:
            type: object
            properties:
              picture_id: 
                type: number
              picture_url:
                type: string
                example: shorturl.at/IJK45
        category:
          type: string
          example: Fruta
        mostwanted:
          type: boolean
          example: false
        stock:
          type: number
          example: 0
    Picture:
      type: object
      properties:
        id:
          type: number
          example: 1
        url:
          type: string
          example: shorturl.at/IJK45
        description:
          type: string
          example: Foto linda de una manzana
    Cart:
      type: object
      properties:
        user: 
          type: number
          example: 1
        Cart:
          type: array
          items:
            type: object
            properties:
              product:
                type: number
                example: 1
              quantity:
                type: number
                example: 5
        
            
